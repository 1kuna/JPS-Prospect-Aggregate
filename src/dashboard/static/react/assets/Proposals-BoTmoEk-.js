import{u as i,r,j as o,A as j,a as y,b as C,B as g,f as v}from"./index-BFCR39p-.js";import{P as f,D as R}from"./DataTable-jZeNWUkw.js";const b=s=>s.proposals,A=s=>s.proposalsPagination,E=s=>s.loading.proposals,K=s=>s.errors.proposals,N=s=>s.fetchProposals;function S(){const s=i(b),e=i(A),d=i(E),c=i(K),a=i(N),[l]=r.useState("release_date"),[n]=r.useState("desc"),h=r.useRef(!1);r.useEffect(()=>{h.current||(console.log("Proposals component mounted, fetching proposals..."),a().then(()=>{console.log("Proposals fetched successfully in component")}).catch(t=>{console.error("Error fetching proposals in component:",t)}),h.current=!0)},[a]),r.useEffect(()=>{console.log("Proposals component state:",{proposals:s,proposalsPagination:e,loading:d,errors:c}),e&&console.log("Pagination data:",{page:e.page,perPage:e.perPage,totalPages:e.totalPages,totalCount:e.totalCount})},[s,e,d,c]);const m=r.useCallback(t=>{console.log("Changing page to:",t),a({page:t,sortBy:l,sortOrder:n})},[a,l,n]),x=r.useCallback(t=>{console.log("Changing items per page to:",t),a({page:1,perPage:t,sortBy:l,sortOrder:n})},[a,l,n]),p=r.useCallback(()=>{console.log("Refreshing proposals..."),a({sortBy:l,sortOrder:n})},[a,l,n]);if(d&&!s.length)return console.log("Rendering loading state..."),o.jsx(f,{title:"Proposals",isLoading:!0,children:o.jsx("div",{children:"Loading proposals..."})});if(c&&!s.length)return console.log("Rendering error state:",c),o.jsxs("div",{className:"space-y-6",children:[o.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Proposals"}),o.jsxs(j,{variant:"destructive",children:[o.jsx(y,{children:"Error loading proposals"}),o.jsx(C,{children:c.message})]}),o.jsx(g,{onClick:p,children:"Retry"})]});console.log("Rendering proposals table with data:",s);const P=[{header:"ID",accessorKey:"id"},{header:"Title",accessorKey:"title"},{header:"Agency",accessorKey:"agency"},{header:"Source",accessorKey:"source_name"},{header:"Release Date",accessorKey:t=>t.release_date?v(t.release_date):"N/A"},{header:"Status",accessorKey:"status"},{header:"Actions",accessorKey:"id",cell:()=>o.jsx(g,{variant:"outline",size:"sm",children:"View"})}],u={page:(e==null?void 0:e.page)||1,perPage:(e==null?void 0:e.perPage)||50,totalPages:(e==null?void 0:e.totalPages)||1,totalItems:(e==null?void 0:e.totalCount)||s.length};return o.jsx(f,{title:"Proposals",children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("div",{children:o.jsxs("p",{className:"text-muted-foreground",children:["Showing ",s.length," of ",u.totalItems," proposals"]})}),o.jsx(g,{onClick:p,children:"Refresh"})]}),o.jsx("div",{children:o.jsx(R,{data:s,columns:P,emptyMessage:"No proposals found",pagination:u,onPageChange:m,onPerPageChange:x,maxHeight:"60vh"})})]})})}export{S as default};
